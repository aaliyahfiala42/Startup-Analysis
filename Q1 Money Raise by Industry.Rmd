---
title: "Money Raised by Industry"
subtitle: "Is the average amount of money raised different between industries?"
date: "2/27/2021"
output: html_document
---
## Introduction
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
```

```{r, echo = T}
#importing Start-up Investments Crunchbase data set.
#Source: https://www.kaggle.com/arindam235/startup-investments-crunchbase

investments <- read.csv("investments_VC.csv", header = TRUE)
dim(investments)

allMarkets <- investments[c("market", "funding_total_usd")]
dim(allMarkets)

markets <- c(" Travel ", " Transportation ", " Games ", " Music ", " Video ", " Finance ", " Cloud Computing ", " Health Care ", " Hospitality ", " Education ")

#filtered to columns of interest, markets of interest, and remove all null funding amounts
d <- allMarkets[which(allMarkets$market %in% markets & allMarkets$funding_total_usd != " -   "), ]
dim(d)
summary(d)

#converting funding to numeric value 
typeof(d$funding_total_usd)
d[, 2] <- sapply(d[, 2], as.numeric)
typeof(d$funding_total_usd)

```

For this analysis we will be comparing the the average amount of money raised in the following industries:
Travel
Transportation
Games
Music
Video
Finance
Cloud Computing
Health Care
Hospitality
Education


We chose these industries because it gives a broad range of comparison and we are curious to see if the total amount raised by start-ups in these industries differs, and if so, we wish to explore how they differ. 
For this analysis I will be performing an ANOVA F-Test to check for $\alpha = 0.05$, if the industries differ. To use the ANOVA F-Test we must first verify that the sample we are using satisfies the three conditions of normality, independence, and equal variance. Since it is likely the variance of funds differs drastically, we will be looking at the log of the total funding. 

```{r}
#frequency of companies across markets in descending order
sorted_markets <- sort(table(d$market), decreasing=TRUE)
markets <- sorted_markets[1:10]
par(mar=c(10, 5, 1, 1)) #adjusting margins
barplot(markets, las=2, axisnames = T)

```



## Verifying Assumptions
### 1. Normality
```{r, echo = T}
#Find the sample size for each market

markets <- c(" Travel ", " Transportation ", " Games ", " Music ", " Video ", " Finance ", " Cloud Computing ", " Health Care ", " Hospitality ", " Education ")
x <- 1:10
for (i in x) {
  cat(markets[i], "sample size: ", dim(d[which(d$market == markets[i]), ])[1], "\n")
}
```
Given that the sample sizes range from a minimum of 86 (Transportation) to a maximum of 1114 (Health Care), we can assume that the Central Limit Theorem will apply and that the means of the samples will follow a normal distribution. 

### 2. Independence
Assuming independence of samples for this case. We have no further information on the data collection methods to confirm independence.That being said no two groups consists of the same company appearing in multiple markets and all companies are expected to be independent startups with no collaboration or affiliation with each other.

### 3. Equal Variance

``` {r, echo = T}
#checking for equal variance
boxplot <- ggplot(d, aes(x = market, y = funding_total_usd))
boxplot + geom_boxplot()

#checking for equal vriance after the log transform
d$funding_total_usd <- log(d$funding_total_usd)
log_boxplot <- ggplot(d, aes(x = market, y = funding_total_usd))
log_boxplot + geom_boxplot()

```

## Performing Analysis

```{r, echo = T}
market <- d$market
funding <- d$funding_total_usd
summary(aov(funding ~ market))
```
Using an ANOVA F-Test with $\alpha = 0.05$, we find evidence to reject the null hypothesis, and conclude that there is a difference in the funding total between the industries of interest.


### Visualising Differences
```{r, echo = T}
#Plot the average funding amounts for each market

markets <- c(" Travel ", " Transportation ", " Games ", " Music ", " Video ", " Finance ", " Cloud Computing ", " Health Care ", " Hospitality ", " Education ")
x <- 1:10
for (i in x) {
  m <- d[which(d$market == markets[i]), ]
  cat(markets[i], "average funding amount: $", mean(m$funding_total_usd), "\n")
}

#plotting means of samples (for each category)
means_data = c()
for(i in markets){
  temp = d[d$market == i,]
  means_data <- c(mean(temp$funding_total_usd), means_data)
}
means_data = as.data.frame(means_data)
markets = as.data.frame(markets)
means <- data.frame(markets, means_data)

ggplot(means, aes(x = reorder(markets, -means_data), y = means_data)) + geom_bar(stat = "identity") + labs(title = "Average Funding Total by Industry", x = "", y = "")
```

